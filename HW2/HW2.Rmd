---
title: "HW2_Alevtina_Bogoliubova-Kuznetsova"
output:
  pdf_document: default
  html_notebook: default
---

## Black Jack probabilities

In your second homework I want you to model Black Jack classic card game.  
You can read rules here: https://www.officialgamerules.org/blackjack  

We have a csv file with a classic 52 card deck.  
Assume that casino has 4 full decks (208 cards).  
Game starts when dealer shuffle all cards and give 2 card for you and 2 for himself.  
To simplify task dealer will always have 2 cards and only you can get additional cards.  
Second thing lets assume that Ace has always 1 point.  
You win if your card sum is more or equal than dealers card sum.  
If your card sum more than 21 you loose.  
Each turn I want you to print game state
  
```{r}
deck <- read.csv('deck.csv')
deck$num <- rep(4, 52)
```

```{r}
draw_card <- function(hand, deck=deck){
  n <- sample.int(52, 1)
  card <- deck[n,]
  if (card$num == 0){
    draw_card(hand, deck)
  }
  else{
    hand <- rbind(hand, card[1:3])
    deck[n,]$num <- deck[n,]$num - 1
  }
  return(hand)
}

print_state <- function(p_hand, d_hand){
  cat("Dealer's hand:\n")
  for (i in c(1:nrow(d_hand))){
    for (j in c(1:3)){
      cat(d_hand[i,j], end = ' ')
    }
    cat("\n")
  }
  sum_d <- 0
  for (i in c(1:nrow(d_hand))){
    sum_d <- sum_d + d_hand[i,3]
  }
  cat("sum: ", sum_d, "\n")
  
  cat("Your hand:\n")
  for (i in c(1:nrow(p_hand))){
    for (j in c(1:3)){
      cat(p_hand[i,j], end = ' ')
    }
    cat("\n")
  }
  sum_p <- 0
  for (i in c(1:nrow(p_hand))){
    sum_p <- sum_p + p_hand[i,3]
  }
  cat("sum: ", sum_p, "\n")
  
  chances <- "?%"
  if (sum_p >= sum_d & sum_p <= 21){
    chances <- "100%"
  }
  if (sum_p > 21){
    chances <- "0%"
  }
  cat("chances:", chances, "\n\n")
}  

start_game <- function(deck){
  deck$num <- rep(4, 52)
  p_hand <- data.frame(row.names = c('face', 'suit', 'value'))
  d_hand <- data.frame(row.names = c('face', 'suit', 'value'))
  repeat{
    p_hand <- draw_card(p_hand, deck)
    d_hand <- draw_card(d_hand, deck)
    if (nrow(p_hand) == 2 & nrow(d_hand) == 2){
      break
    }
  }
  
  print_state(p_hand, d_hand)
  a <- list(p_hand, d_hand)
  return(a)
}

deal <- function(lst){
  p_hand <- data.frame(lst[1])
  d_hand <- data.frame(lst[2])
  p_hand <- draw_card(p_hand, deck)
  print_state(p_hand, d_hand)
  a <- list(p_hand, d_hand)
  return(a)
}

stop_game <- function(lst){
  p_hand <- data.frame(lst[1])
  d_hand <- data.frame(lst[2])
  sum_d <- 0
  for (i in c(1:nrow(d_hand))){
    sum_d <- sum_d + d_hand[i,3]
  }
  sum_p <- 0
  for (i in c(1:nrow(p_hand))){
    sum_p <- sum_p + p_hand[i,3]
  }
  if (sum_p >= sum_d & sum_p <= 21){
    cat("win")
  }
  else{
    cat("loose")
  }
}
```

```{r}
#game_1
stop_game(deal(start_game(deck)))
```
```{r}
stop_game(start_game(deck))
```
